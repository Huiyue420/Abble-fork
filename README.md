# 大富翁 Godot 多人連線系統

這是一個專為 Godot 4 設計的基礎多人連線大廳 (Lobby) 腳本。它使用 Godot 內建的高階多人 API (`High-level Multiplayer API`)，基於 `ENet` 協議。

## 如何使用

### 1. 建立場景
1. 打開 Godot 編輯器。
2. 建立一個新的 **User Interface** (Control) 場景。
3. 將根節點重新命名為 `Lobby` (選用)。

### 2. 掛載腳本
1. 在檔案系統視窗找到 `Lobby.gd`。
2. 將 `Lobby.gd` 拖曳到剛剛建立的根節點上。
3. **執行場景** (按 F6)。

您會看到一個自動產生的介面，包含：
- IP 輸入欄
- 建立主機 (Host) 按鈕
- 加入遊戲 (Join) 按鈕
- 狀態顯示文字

### 3. 連線測試
為了測試多人連線，您需要同時執行兩個遊戲實體：
1. **Host 端**:
   - 執行第一次遊戲。
   - 點擊「建立主機 (Host)」。
   - 狀態會顯示「伺服器已建立」，並顯示您的區域網路 IP。
2. **Client 端**:
   - 再次執行遊戲 (若在編輯器中，可點擊上方選單 `Debug` -> `Run Multiple Instances` 並設定為 2 個實體)。
   - 在 IP 欄位輸入 Host 的 IP (如果是本機測試請保留 `127.0.0.1`)。
   - 點擊「加入遊戲 (Join)」。
   - 若成功，雙方都會看到連線成功的訊息。

## 連線原理

Godot 使用 `ENetMultiplayerPeer` 來處理網路封包。

1. **Host (Server)**: 負責開啟一個特定的連接埠 (Port，此腳本預設為 `7777`) 並監聽來自其他人的請求。
2. **Join (Client)**: 需要知道 Host 的 **IP 位址** 與 **Port**，才能發送連線請求。
3. **RPC (Remote Procedure Call)**: 連線建立後，您可以使用 `@rpc` 關鍵字在腳本中定義函式，讓一台電腦呼叫另一台電腦上的函式（例如：同步玩家位置、擲骰子結果）。

## 如何與他人進行遠端連線

### 情況一：在同一個區域網路 (同一個 WiFi/路由器)
1. **Host**: 按下 Host 後，告訴朋友畫面顯示的 IP (通常是 `192.168.x.x`)。
2. **Client**: 朋友在他的電腦輸入該 IP 並點擊 Join。
3. **注意**: Windows 防火牆可能會跳出警告，請務必選擇「允許存取」。

### 情況二：透過網際網路 (不同住處)
若朋友在不同地方，您需要讓您的電腦能被外部網路存取。

**方法 A: 使用虛擬區域網路軟體 (推薦，最簡單)**
使用 **Radmin VPN** 或 **Hamachi**。
1. 您與朋友都安裝 Radmin VPN。
2. 建立一個網路群組，讓朋友加入。
3. Radmin 會給您一個虛擬 IP。
4. Host 使用該虛擬 IP 開服，Client 輸入該虛擬 IP 連線。

**方法 B: 端口轉發 (Port Forwarding)**
進入您的路由器設定頁面，將 Port `7777` (UDP) 轉發到您的電腦 IP。這樣朋友輸入您的**真實公網 IP** (可 Google "what is my ip") 即可連線。

**方法 C: Ngrok (進階)**
使用 `ngrok tcp 7777` 將端口暴露到公網 (需註冊 Ngrok 帳號並設定 TCP 通道)。
